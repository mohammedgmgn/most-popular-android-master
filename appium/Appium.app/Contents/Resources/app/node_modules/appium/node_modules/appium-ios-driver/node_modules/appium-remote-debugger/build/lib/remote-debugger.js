"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.RPC_RESPONSE_TIMEOUT_MS = exports.REMOTE_DEBUGGER_PORT = exports.DEBUGGER_TYPES = exports.RemoteDebugger = void 0;

require("source-map-support/register");

var _events = _interopRequireDefault(require("events"));

var _logger = _interopRequireDefault(require("./logger"));

var _appiumBaseDriver = require("appium-base-driver");

var _remoteDebuggerRpcClient = _interopRequireDefault(require("./remote-debugger-rpc-client"));

var _messageHandlers = _interopRequireDefault(require("./message-handlers"));

var _helpers = require("./helpers");

var _appiumSupport = require("appium-support");

var _lodash = _interopRequireDefault(require("lodash"));

var _bluebird = _interopRequireDefault(require("bluebird"));

const DEBUGGER_TYPES = {
  webkit: 1,
  webinspector: 2
};
exports.DEBUGGER_TYPES = DEBUGGER_TYPES;
const SELECT_APP_RETRIES = 20;
const REMOTE_DEBUGGER_PORT = 27753;
exports.REMOTE_DEBUGGER_PORT = REMOTE_DEBUGGER_PORT;
const RPC_RESPONSE_TIMEOUT_MS = 5000;
exports.RPC_RESPONSE_TIMEOUT_MS = RPC_RESPONSE_TIMEOUT_MS;
const PAGE_READY_TIMEOUT = 5000;
const RESPONSE_LOG_LENGTH = 100;
const GARBAGE_COLLECT_TIMEOUT = 5000;

class RemoteDebugger extends _events.default.EventEmitter {
  constructor(opts = {}) {
    super();
    const {
      bundleId,
      platformVersion,
      debuggerType = DEBUGGER_TYPES.webinspector,
      isSafari = true,
      useNewSafari = false,
      pageLoadMs,
      host,
      port = REMOTE_DEBUGGER_PORT,
      socketPath,
      pageReadyTimeout = PAGE_READY_TIMEOUT,
      remoteDebugProxy,
      garbageCollectOnExecute = false
    } = opts;
    this.bundleId = bundleId;
    this.platformVersion = platformVersion;
    this.isSafari = isSafari;
    this.debuggerType = debuggerType;

    if (this.debuggerType === DEBUGGER_TYPES.webinspector) {
      this.useNewSafari = useNewSafari;
      this.pageLoadMs = pageLoadMs;

      _logger.default.debug(`useNewSafari --> ${this.useNewSafari}`);
    }

    this.garbageCollectOnExecute = garbageCollectOnExecute;
    this.host = host;
    this.port = port;
    this.socketPath = socketPath;
    this.remoteDebugProxy = remoteDebugProxy;
    this.pageReadyTimeout = pageReadyTimeout;
  }

  setup() {
    this.appDict = {};
    this.appIdKey = null;
    this.pageIdKey = null;
    this.pageLoading = false;
    this.specialCbs = {
      '_rpc_reportIdentifier:': _lodash.default.noop,
      '_rpc_forwardGetListing:': this.onPageChange.bind(this),
      '_rpc_reportConnectedApplicationList:': _lodash.default.noop,
      '_rpc_applicationConnected:': this.onAppConnect.bind(this),
      '_rpc_applicationDisconnected:': this.onAppDisconnect.bind(this),
      '_rpc_applicationUpdated:': this.onAppUpdate.bind(this),
      '_rpc_reportConnectedDriverList:': this.onReportDriverList.bind(this),
      pageLoad: this.pageLoad.bind(this),
      frameDetached: this.frameDetached.bind(this),
      targetCreated: this.onTargetCreated.bind(this),
      targetDestroyed: this.onTargetDestroyed.bind(this)
    };
    this.rpcClient = null;
  }

  teardown() {
    _logger.default.debug('Cleaning up listeners');

    this.appDict = {};
    this.appIdKey = null;
    this.pageIdKey = null;
    this.pageLoading = false;
    this.specialCbs = {};
    this.rpcClient = null;
    this.removeAllListeners(RemoteDebugger.EVENT_PAGE_CHANGE);
    this.removeAllListeners(RemoteDebugger.EVENT_DISCONNECT);
  }

  async connect() {
    this.setup();
    this.rpcClient = new _remoteDebuggerRpcClient.default({
      platformVersion: this.platformVersion,
      isSafari: this.isSafari,
      host: this.host,
      port: this.port,
      socketPath: this.socketPath,
      specialMessageHandlers: this.specialCbs,
      messageProxy: this.remoteDebugProxy
    });
    await this.rpcClient.connect();

    try {
      let appInfo = await this.setConnectionKey();

      _logger.default.debug('Connected to application');

      return appInfo;
    } catch (err) {
      await this.disconnect();
      return null;
    }
  }

  async disconnect() {
    await this.rpcClient.disconnect();
    this.emit(RemoteDebugger.EVENT_DISCONNECT, true);
    this.teardown();
  }

  isConnected() {
    return !!(this.rpcClient && this.rpcClient.isConnected());
  }

  async setConnectionKey() {
    return await new _bluebird.default((resolve, reject) => {
      let connectCb = apps => {
        if (_lodash.default.isUndefined(apps) || _lodash.default.keys(apps).length === 0) {
          _logger.default.debug('Received no apps from remote debugger. Unable to connect.');

          return resolve(this.appDict);
        }

        let newDict = {};

        for (const dict of _lodash.default.values(apps)) {
          let [id, entry] = (0, _helpers.appInfoFromDict)(dict);
          newDict[id] = entry;
        }

        _lodash.default.defaults(this.appDict, newDict);

        resolve(newDict);
      };

      this.rpcClient.setSpecialMessageHandler('_rpc_reportConnectedApplicationList:', reject, connectCb);

      _logger.default.debug('Sending connection key request');

      return (async () => {
        let [simNameKey, simBuildKey, simPlatformVersion] = await this.rpcClient.send('setConnectionKey');

        _logger.default.debug(`Sim name: ${simNameKey}`);

        _logger.default.debug(`Sim build: ${simBuildKey}`);

        _logger.default.debug(`Sim platform version: ${simPlatformVersion}`);
      })();
    });
  }

  updateAppsWithDict(dict) {
    this.appDict = this.appDict || {};
    let [id, entry] = (0, _helpers.appInfoFromDict)(dict);

    if (this.appDict[id]) {
      entry.pageArray = this.appDict[id].pageArray;
    }

    this.appDict[id] = entry;

    if (_lodash.default.isUndefined(entry.pageArray)) {
      entry.pageArray = (0, _helpers.deferredPromise)();
    }

    if (!this.appIdKey) {
      this.appIdKey = (0, _helpers.getDebuggerAppKey)(this.bundleId, this.platformVersion, this.appDict);
    }
  }

  logApplicationDictionary(apps) {
    function getValueString(key, value) {
      if (_lodash.default.isFunction(value)) {
        return '[Function]';
      }

      if (key === 'pageDict' && !_lodash.default.isArray(value)) {
        return `'Waiting for data'`;
      }

      return JSON.stringify(value);
    }

    _logger.default.debug('Current applications available:');

    for (const [app, info] of _lodash.default.toPairs(apps)) {
      _logger.default.debug(`    Application: '${app}'`);

      for (const [key, value] of _lodash.default.toPairs(info)) {
        const valueString = getValueString(key, value);

        _logger.default.debug(`        ${key}: ${valueString}`);
      }
    }
  }

  async selectApp(currentUrl = null, maxTries = SELECT_APP_RETRIES, ignoreAboutBlankUrl = false) {
    _logger.default.debug('Selecting application');

    if (!this.appDict || _lodash.default.keys(this.appDict).length === 0) {
      _logger.default.debug('No applications currently connected.');

      return [];
    }

    let pageDict, appIdKey;

    appLoop: for (let i = 0; i < maxTries; i++) {
      this.logApplicationDictionary(this.appDict);
      let possibleAppIds = (0, _helpers.getPossibleDebuggerAppKeys)(this.bundleId, this.platformVersion, this.appDict);

      _logger.default.debug(`Trying out the possible app ids: ${possibleAppIds.join(', ')}`);

      for (const attemptedAppIdKey of possibleAppIds) {
        try {
          _logger.default.debug(`Selecting app ${attemptedAppIdKey} (try #${i + 1} of ${maxTries})`);

          [appIdKey, pageDict] = await this.rpcClient.selectApp(attemptedAppIdKey, this.onAppConnect.bind(this));

          if (_lodash.default.isEmpty(pageDict)) {
            _logger.default.debug('Empty page dictionary received. Trying again.');

            continue;
          }

          this.appDict[appIdKey].pageArray = (0, _helpers.pageArrayFromDict)(pageDict);
          let found = false;

          dictLoop: for (const appDict of _lodash.default.values(this.appDict)) {
            if (found) break;

            if (!appDict || !appDict.pageArray) {
              continue;
            }

            if (appDict.pageArray.promise) {
              try {
                await _bluebird.default.resolve(appDict.pageArray.promise).timeout(10000);
              } catch (err) {
                if (!(err instanceof _bluebird.default.TimeoutError)) {
                  throw err;
                }

                continue;
              }
            }

            for (const dict of appDict.pageArray || []) {
              if ((!ignoreAboutBlankUrl || dict.url !== 'about:blank') && (!currentUrl || dict.url === currentUrl)) {
                appIdKey = appDict.id;
                pageDict = dict;
                found = true;
                break dictLoop;
              }
            }
          }

          if (!found) {
            if (currentUrl) {
              _logger.default.debug(`Received app, but expected url ('${currentUrl}') was not found. Trying again.`);
            } else {
              _logger.default.debug('Received app, but no match was found. Trying again.');
            }

            pageDict = null;
            continue;
          }

          break appLoop;
        } catch (err) {
          _logger.default.debug(`Error checking application: '${err.message}'. Retrying connection`);
        }
      }
    }

    if (!pageDict) {
      _logger.default.errorAndThrow(`Could not connect to a valid app after ${maxTries} tries.`);
    }

    if (this.appIdKey !== appIdKey) {
      _logger.default.debug(`Received altered app id, updating from '${this.appIdKey}' to '${appIdKey}'`);

      this.appIdKey = appIdKey;
    }

    const pagePromises = Object.values(this.appDict).filter(app => !!app.pageArray && !!app.pageArray.promise).map(app => app.pageArray.promise);

    if (pagePromises.length) {
      _logger.default.debug(`Waiting for ${pagePromises.length} pages to be fulfilled`);

      await _bluebird.default.any([_bluebird.default.delay(30000), _bluebird.default.all(pagePromises)]);
    }

    const pageArray = _lodash.default.isEmpty(this.appDict[appIdKey].pageArray) ? (0, _helpers.pageArrayFromDict)(pageDict) : this.appDict[appIdKey].pageArray;

    _logger.default.debug(`Finally selecting app ${this.appIdKey}: ${(0, _helpers.simpleStringify)(pageArray)}`);

    let fullPageArray = [];

    for (const [app, info] of _lodash.default.toPairs(this.appDict)) {
      if (!_lodash.default.isArray(info.pageArray)) continue;
      let id = app.replace('PID:', '');

      for (const page of info.pageArray) {
        if (page.url && (!ignoreAboutBlankUrl || page.url !== 'about:blank') && (!currentUrl || page.url === currentUrl)) {
          let pageDict = _lodash.default.clone(page);

          pageDict.id = `${id}.${pageDict.id}`;
          fullPageArray.push(pageDict);
        }
      }
    }

    return fullPageArray;
  }

  async selectPage(appIdKey, pageIdKey, skipReadyCheck = false) {
    this.appIdKey = `PID:${appIdKey}`;
    this.pageIdKey = pageIdKey;

    _logger.default.debug(`Selecting page '${pageIdKey}' on app '${this.appIdKey}' and forwarding socket setup`);

    await this.rpcClient.send('setSenderKey', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey
    });

    _logger.default.debug('Sender key set');

    await this.rpcClient.send('enablePage', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType,
      targetId: 'page-1'
    });

    _logger.default.debug('Enabled activity on page');

    if (!skipReadyCheck && !(await this.checkPageIsReady())) {
      await this.pageUnload();
    }
  }

  async executeAtom(atom, args, frames) {
    if (!this.rpcClient.connected) throw new Error('Remote debugger is not connected');

    _logger.default.debug(`Executing atom '${atom}'`);

    const script = await (0, _helpers.getScriptForAtom)(atom, args, frames);
    const value = await this.execute(script, true);

    _logger.default.debug(`Received result for atom '${atom}' execution: ${_lodash.default.truncate((0, _helpers.simpleStringify)(value), {
      length: RESPONSE_LOG_LENGTH
    })}`);

    return value;
  }

  async executeAtomAsync(atom, args, frames, responseUrl) {
    let asyncCallBack = `function (res) { xmlHttp = new XMLHttpRequest(); ` + `xmlHttp.open('POST', '${responseUrl}', true);` + `xmlHttp.setRequestHeader('Content-type','application/json'); ` + `xmlHttp.send(res); }`;
    let script = await (0, _helpers.getScriptForAtom)(atom, args, frames, asyncCallBack);
    await this.execute(script);
  }

  frameDetached() {
    this.emit(RemoteDebugger.EVENT_FRAMES_DETACHED);
  }

  async pageLoad(startPageLoadMs, pageLoadVerifyHook) {
    let timeoutMs = 500;
    let start = startPageLoadMs || Date.now();

    _logger.default.debug('Page loaded, verifying whether ready');

    const verify = async () => {
      this.pageLoadDelay = _appiumSupport.util.cancellableDelay(timeoutMs);

      try {
        await this.pageLoadDelay;
      } catch (err) {
        if (err instanceof _bluebird.default.CancellationError) {
          return;
        }
      }

      if (!this.appIdKey) {
        _logger.default.debug('Not connected to an application. Ignoring page load');

        return;
      }

      if (_lodash.default.isFunction(pageLoadVerifyHook)) {
        await pageLoadVerifyHook();
      }

      const ready = await this.checkPageIsReady();

      if (ready || this.pageLoadMs > 0 && start + this.pageLoadMs < Date.now()) {
        _logger.default.debug('Page is ready');

        this.pageLoading = false;
      } else {
        _logger.default.debug('Page was not ready, retrying');

        await verify();
      }
    };

    await verify();
  }

  cancelPageLoad() {
    _logger.default.debug('Unregistering from page readiness notifications');

    this.pageLoading = false;

    if (this.pageLoadDelay) {
      this.pageLoadDelay.cancel();
    }
  }

  async pageUnload() {
    _logger.default.debug('Page unloading');

    this.pageLoading = true;
    await this.waitForDom();
  }

  async waitForDom(startPageLoadMs, pageLoadVerifyHook) {
    _logger.default.debug('Waiting for dom...');

    await this.pageLoad(startPageLoadMs, pageLoadVerifyHook);
  }

  async checkPageIsReady() {
    const errors = (0, _helpers.checkParams)({
      appIdKey: this.appIdKey
    });
    if (errors) throw new Error(errors);

    _logger.default.debug('Checking document readyState');

    const readyCmd = '(function (){ return document.readyState; })()';
    let readyState = 'loading';

    try {
      readyState = await _bluebird.default.resolve(this.execute(readyCmd, true)).timeout(this.pageReadyTimeout);
    } catch (err) {
      if (!(err instanceof _bluebird.default.TimeoutError)) {
        throw err;
      }

      _logger.default.debug(`Page readiness check timed out after ${this.pageReadyTimeout}ms`);

      return false;
    }

    _logger.default.debug(`Document readyState is '${readyState}'`);

    return readyState === 'complete';
  }

  async navToUrl(url, pageLoadVerifyHook) {
    if (this.debuggerType === DEBUGGER_TYPES.webinspector) {
      let errors = (0, _helpers.checkParams)({
        appIdKey: this.appIdKey,
        pageIdKey: this.pageIdKey
      });
      if (errors) throw new Error(errors);
    }

    _logger.default.debug(`Navigating to new URL: ${url}`);

    await this.rpcClient.send('setUrl', {
      url,
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });

    if (!this.useNewSafari) {
      await _bluebird.default.delay(1000);
    }

    if (this.debuggerType === DEBUGGER_TYPES.webinspector) {
      await this.waitForFrameNavigated();
    }

    await this.waitForDom(Date.now(), pageLoadVerifyHook);
  }

  async waitForFrameNavigated() {
    return await new _bluebird.default(async (resolve, reject) => {
      _logger.default.debug('Waiting for frame navigated message...');

      let startMs = Date.now();

      let navEventListener = value => {
        _logger.default.debug(`Frame navigated in ${(Date.now() - startMs) / 1000} sec from source: ${value}`);

        if (this.navigationDelay) {
          this.navigationDelay.cancel();
        }

        resolve(value);
      };

      this.rpcClient.setSpecialMessageHandler('Page.frameNavigated', reject, navEventListener);

      if (!this.useNewSafari || this.pageLoadMs >= 0) {
        let timeout = this.useNewSafari ? this.pageLoadMs : 500;
        this.navigationDelay = _appiumSupport.util.cancellableDelay(timeout);

        try {
          await this.navigationDelay;
          navEventListener('timeout');
        } catch (err) {}
      }
    });
  }

  async startTimeline(fn) {
    _logger.default.debug('Starting to record the timeline');

    this.rpcClient.setTimelineEventHandler(fn);
    return await this.rpcClient.send('startTimeline', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async stopTimeline() {
    _logger.default.debug('Stopping to record the timeline');

    await this.rpcClient.send('stopTimeline', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async startConsole(fn) {
    _logger.default.debug('Starting to listen for JavaScript console');

    this.rpcClient.setConsoleLogEventHandler(fn);
    return await this.rpcClient.send('startConsole', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async stopConsole() {
    _logger.default.debug('Stopping to listen for JavaScript console');

    await this.rpcClient.send('stopConsole', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async startNetwork(fn) {
    _logger.default.debug('Starting to listen for network events');

    this.rpcClient.setNetworkLogEventHandler(fn);
    return await this.rpcClient.send('startNetwork', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async stopNetwork() {
    _logger.default.debug('Stopping to listen for network events');

    await this.rpcClient.send('stopNetwork', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async execute(command, override) {
    if (this.pageLoading && !override) {
      _logger.default.debug('Trying to execute but page is not loaded.');

      await this.waitForDom();
    }

    if (this.debuggerType === DEBUGGER_TYPES.webinspector) {
      let errors = (0, _helpers.checkParams)({
        appIdKey: this.appIdKey,
        pageIdKey: this.pageIdKey
      });
      if (errors) throw new Error(errors);
    }

    if (this.garbageCollectOnExecute) {
      await this.garbageCollect();
    }

    _logger.default.debug(`Sending javascript command ${_lodash.default.truncate(command, {
      length: 50
    })}`);

    let res = await this.rpcClient.send('sendJSCommand', {
      command,
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
    return this.convertResult(res);
  }

  async callFunction(objId, fn, args) {
    let errors = (0, _helpers.checkParams)({
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey
    });
    if (errors) throw new Error(errors);

    if (this.garbageCollectOnExecute) {
      await this.garbageCollect();
    }

    _logger.default.debug('Calling javascript function');

    const res = await this.rpcClient.send('callJSFunction', {
      objId,
      fn,
      args,
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
    return this.convertResult(res);
  }

  convertResult(res) {
    if (_lodash.default.isUndefined(res)) {
      throw new Error(`Did not get OK result from remote debugger. Result was: ${_lodash.default.truncate((0, _helpers.simpleStringify)(res), {
        length: RESPONSE_LOG_LENGTH
      })}`);
    } else if (_lodash.default.isString(res)) {
      try {
        res = JSON.parse(res);
      } catch (err) {}
    } else if (!_lodash.default.isObject(res)) {
      throw new Error(`Result has unexpected type: (${typeof res}).`);
    }

    if (res.status && res.status !== 0) {
      throw (0, _appiumBaseDriver.errorFromCode)(res.status, res.value.message || res.value);
    }

    return res.hasOwnProperty('value') ? res.value : res;
  }

  allowNavigationWithoutReload(allow = true) {
    if (_lodash.default.isFunction(this.rpcClient.allowNavigationWithoutReload)) {
      this.rpcClient.allowNavigationWithoutReload(allow);
    }
  }

  async getCookies(urls) {
    _logger.default.debug('Getting network cookies');

    return await this.rpcClient.send('getCookies', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType,
      urls
    });
  }

  async deleteCookie(cookieName, url) {
    _logger.default.debug(`Deleting cookie '${cookieName}' on '${url}'`);

    return await this.rpcClient.send('deleteCookie', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType,
      cookieName,
      url
    });
  }

  async garbageCollect(timeoutMs = GARBAGE_COLLECT_TIMEOUT) {
    _logger.default.debug(`Garbage collecting with ${timeoutMs}ms timeout`);

    const errors = (0, _helpers.checkParams)({
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey
    });

    if (errors) {
      _logger.default.debug(`Unable to collect garbage at this time`);

      return;
    }

    await _bluebird.default.resolve(this.rpcClient.send('garbageCollect', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    })).timeout(timeoutMs).then(function () {
      _logger.default.debug(`Garbage collection successful`);
    }).catch(function (err) {
      if (err instanceof _bluebird.default.TimeoutError) {
        _logger.default.debug(`Garbage collection timed out after ${timeoutMs}ms`);
      } else {
        _logger.default.debug(`Unable to collect garbage: ${err.message}`);
      }
    });
  }

}

exports.RemoteDebugger = RemoteDebugger;
RemoteDebugger.EVENT_PAGE_CHANGE = 'remote_debugger_page_change';
RemoteDebugger.EVENT_FRAMES_DETACHED = 'remote_debugger_frames_detached';
RemoteDebugger.EVENT_DISCONNECT = 'remote_debugger_disconnect';

for (const [name, handler] of _lodash.default.toPairs(_messageHandlers.default)) {
  RemoteDebugger.prototype[name] = handler;
}require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9yZW1vdGUtZGVidWdnZXIuanMiXSwibmFtZXMiOlsiREVCVUdHRVJfVFlQRVMiLCJ3ZWJraXQiLCJ3ZWJpbnNwZWN0b3IiLCJTRUxFQ1RfQVBQX1JFVFJJRVMiLCJSRU1PVEVfREVCVUdHRVJfUE9SVCIsIlJQQ19SRVNQT05TRV9USU1FT1VUX01TIiwiUEFHRV9SRUFEWV9USU1FT1VUIiwiUkVTUE9OU0VfTE9HX0xFTkdUSCIsIkdBUkJBR0VfQ09MTEVDVF9USU1FT1VUIiwiUmVtb3RlRGVidWdnZXIiLCJldmVudHMiLCJFdmVudEVtaXR0ZXIiLCJjb25zdHJ1Y3RvciIsIm9wdHMiLCJidW5kbGVJZCIsInBsYXRmb3JtVmVyc2lvbiIsImRlYnVnZ2VyVHlwZSIsImlzU2FmYXJpIiwidXNlTmV3U2FmYXJpIiwicGFnZUxvYWRNcyIsImhvc3QiLCJwb3J0Iiwic29ja2V0UGF0aCIsInBhZ2VSZWFkeVRpbWVvdXQiLCJyZW1vdGVEZWJ1Z1Byb3h5IiwiZ2FyYmFnZUNvbGxlY3RPbkV4ZWN1dGUiLCJsb2ciLCJkZWJ1ZyIsInNldHVwIiwiYXBwRGljdCIsImFwcElkS2V5IiwicGFnZUlkS2V5IiwicGFnZUxvYWRpbmciLCJzcGVjaWFsQ2JzIiwiXyIsIm5vb3AiLCJvblBhZ2VDaGFuZ2UiLCJiaW5kIiwib25BcHBDb25uZWN0Iiwib25BcHBEaXNjb25uZWN0Iiwib25BcHBVcGRhdGUiLCJvblJlcG9ydERyaXZlckxpc3QiLCJwYWdlTG9hZCIsImZyYW1lRGV0YWNoZWQiLCJ0YXJnZXRDcmVhdGVkIiwib25UYXJnZXRDcmVhdGVkIiwidGFyZ2V0RGVzdHJveWVkIiwib25UYXJnZXREZXN0cm95ZWQiLCJycGNDbGllbnQiLCJ0ZWFyZG93biIsInJlbW92ZUFsbExpc3RlbmVycyIsIkVWRU5UX1BBR0VfQ0hBTkdFIiwiRVZFTlRfRElTQ09OTkVDVCIsImNvbm5lY3QiLCJSZW1vdGVEZWJ1Z2dlclJwY0NsaWVudCIsInNwZWNpYWxNZXNzYWdlSGFuZGxlcnMiLCJtZXNzYWdlUHJveHkiLCJhcHBJbmZvIiwic2V0Q29ubmVjdGlvbktleSIsImVyciIsImRpc2Nvbm5lY3QiLCJlbWl0IiwiaXNDb25uZWN0ZWQiLCJCIiwicmVzb2x2ZSIsInJlamVjdCIsImNvbm5lY3RDYiIsImFwcHMiLCJpc1VuZGVmaW5lZCIsImtleXMiLCJsZW5ndGgiLCJuZXdEaWN0IiwiZGljdCIsInZhbHVlcyIsImlkIiwiZW50cnkiLCJkZWZhdWx0cyIsInNldFNwZWNpYWxNZXNzYWdlSGFuZGxlciIsInNpbU5hbWVLZXkiLCJzaW1CdWlsZEtleSIsInNpbVBsYXRmb3JtVmVyc2lvbiIsInNlbmQiLCJ1cGRhdGVBcHBzV2l0aERpY3QiLCJwYWdlQXJyYXkiLCJsb2dBcHBsaWNhdGlvbkRpY3Rpb25hcnkiLCJnZXRWYWx1ZVN0cmluZyIsImtleSIsInZhbHVlIiwiaXNGdW5jdGlvbiIsImlzQXJyYXkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXBwIiwiaW5mbyIsInRvUGFpcnMiLCJ2YWx1ZVN0cmluZyIsInNlbGVjdEFwcCIsImN1cnJlbnRVcmwiLCJtYXhUcmllcyIsImlnbm9yZUFib3V0QmxhbmtVcmwiLCJwYWdlRGljdCIsImFwcExvb3AiLCJpIiwicG9zc2libGVBcHBJZHMiLCJqb2luIiwiYXR0ZW1wdGVkQXBwSWRLZXkiLCJpc0VtcHR5IiwiZm91bmQiLCJkaWN0TG9vcCIsInByb21pc2UiLCJ0aW1lb3V0IiwiVGltZW91dEVycm9yIiwidXJsIiwibWVzc2FnZSIsImVycm9yQW5kVGhyb3ciLCJwYWdlUHJvbWlzZXMiLCJPYmplY3QiLCJmaWx0ZXIiLCJtYXAiLCJhbnkiLCJkZWxheSIsImFsbCIsImZ1bGxQYWdlQXJyYXkiLCJyZXBsYWNlIiwicGFnZSIsImNsb25lIiwicHVzaCIsInNlbGVjdFBhZ2UiLCJza2lwUmVhZHlDaGVjayIsInRhcmdldElkIiwiY2hlY2tQYWdlSXNSZWFkeSIsInBhZ2VVbmxvYWQiLCJleGVjdXRlQXRvbSIsImF0b20iLCJhcmdzIiwiZnJhbWVzIiwiY29ubmVjdGVkIiwiRXJyb3IiLCJzY3JpcHQiLCJleGVjdXRlIiwidHJ1bmNhdGUiLCJleGVjdXRlQXRvbUFzeW5jIiwicmVzcG9uc2VVcmwiLCJhc3luY0NhbGxCYWNrIiwiRVZFTlRfRlJBTUVTX0RFVEFDSEVEIiwic3RhcnRQYWdlTG9hZE1zIiwicGFnZUxvYWRWZXJpZnlIb29rIiwidGltZW91dE1zIiwic3RhcnQiLCJEYXRlIiwibm93IiwidmVyaWZ5IiwicGFnZUxvYWREZWxheSIsInV0aWwiLCJjYW5jZWxsYWJsZURlbGF5IiwiQ2FuY2VsbGF0aW9uRXJyb3IiLCJyZWFkeSIsImNhbmNlbFBhZ2VMb2FkIiwiY2FuY2VsIiwid2FpdEZvckRvbSIsImVycm9ycyIsInJlYWR5Q21kIiwicmVhZHlTdGF0ZSIsIm5hdlRvVXJsIiwid2FpdEZvckZyYW1lTmF2aWdhdGVkIiwic3RhcnRNcyIsIm5hdkV2ZW50TGlzdGVuZXIiLCJuYXZpZ2F0aW9uRGVsYXkiLCJzdGFydFRpbWVsaW5lIiwiZm4iLCJzZXRUaW1lbGluZUV2ZW50SGFuZGxlciIsInN0b3BUaW1lbGluZSIsInN0YXJ0Q29uc29sZSIsInNldENvbnNvbGVMb2dFdmVudEhhbmRsZXIiLCJzdG9wQ29uc29sZSIsInN0YXJ0TmV0d29yayIsInNldE5ldHdvcmtMb2dFdmVudEhhbmRsZXIiLCJzdG9wTmV0d29yayIsImNvbW1hbmQiLCJvdmVycmlkZSIsImdhcmJhZ2VDb2xsZWN0IiwicmVzIiwiY29udmVydFJlc3VsdCIsImNhbGxGdW5jdGlvbiIsIm9iaklkIiwiaXNTdHJpbmciLCJwYXJzZSIsImlzT2JqZWN0Iiwic3RhdHVzIiwiaGFzT3duUHJvcGVydHkiLCJhbGxvd05hdmlnYXRpb25XaXRob3V0UmVsb2FkIiwiYWxsb3ciLCJnZXRDb29raWVzIiwidXJscyIsImRlbGV0ZUNvb2tpZSIsImNvb2tpZU5hbWUiLCJ0aGVuIiwiY2F0Y2giLCJuYW1lIiwiaGFuZGxlciIsIm1lc3NhZ2VIYW5kbGVycyIsInByb3RvdHlwZSJdLCJtYXBwaW5n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S0FBS0EsU0FGb0M7QUFHcERmLE1BQUFBLFlBQVksRUFBRSxLQUFLQTtBQUhpQyxLQUF0QyxDQUFWLEVBSUY4RixPQUpFLENBSU1xQyxTQUpOLEVBS0xpRCxJQUxLLENBS0EsWUFBWTtBQUNoQjFLLHNCQUFJQyxLQUFKLENBQVcsK0JBQVg7QUFDRCxLQVBLLEVBT0gwSyxLQVBHLENBT0csVUFBVTFJLEdBQVYsRUFBZTtBQUN0QixVQUFJQSxHQUFHLFlBQVlJLGtCQUFFZ0QsWUFBckIsRUFBbUM7QUFDakNyRix3QkFBSUMsS0FBSixDQUFXLHNDQUFxQ3dILFNBQVUsSUFBMUQ7QUFDRCxPQUZELE1BRU87QUFDTHpILHdCQUFJQyxLQUFKLENBQVcsOEJBQTZCZ0MsR0FBRyxDQUFDc0QsT0FBUSxFQUFwRDtBQUNEO0FBQ0YsS0FiSyxDQUFOO0FBY0Q7O0FBcnJCOEM7OztBQXlyQmpEeEcsY0FBYyxDQUFDMEMsaUJBQWYsR0FBbUMsNkJBQW5DO0FBQ0ExQyxjQUFjLENBQUN1SSxxQkFBZixHQUF1QyxpQ0FBdkM7QUFDQXZJLGNBQWMsQ0FBQzJDLGdCQUFmLEdBQWtDLDRCQUFsQzs7QUFHQSxLQUFLLE1BQU0sQ0FBQ2tKLElBQUQsRUFBT0MsT0FBUCxDQUFYLElBQThCckssZ0JBQUU0RCxPQUFGLENBQVUwRyx3QkFBVixDQUE5QixFQUEwRDtBQUN4RC9MLEVBQUFBLGNBQWMsQ0FBQ2dNLFNBQWYsQ0FBeUJILElBQXpCLElBQWlDQyxPQUFqQztBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiLy8gdHJhbnNwaWxlOm1haW5cbmltcG9ydCBldmVudHMgZnJvbSAnZXZlbnRzJztcbmltcG9ydCBsb2cgZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHsgZXJyb3JGcm9tQ29kZSB9IGZyb20gJ2FwcGl1bS1iYXNlLWRyaXZlcic7XG5pbXBvcnQgUmVtb3RlRGVidWdnZXJScGNDbGllbnQgZnJvbSAnLi9yZW1vdGUtZGVidWdnZXItcnBjLWNsaWVudCc7XG5pbXBvcnQgbWVzc2FnZUhhbmRsZXJzIGZyb20gJy4vbWVzc2FnZS1oYW5kbGVycyc7XG5pbXBvcnQgeyBhcHBJbmZvRnJvbURpY3QsIHBhZ2VBcnJheUZyb21EaWN0LCBnZXREZWJ1Z2dlckFwcEtleSxcbiAgICAgICAgIGdldFBvc3NpYmxlRGVidWdnZXJBcHBLZXlzLCBjaGVja1BhcmFtcywgZ2V0U2NyaXB0Rm9yQXRvbSxcbiAgICAgICAgIHNpbXBsZVN0cmluZ2lmeSwgZGVmZXJyZWRQcm9taXNlIH0gZnJvbSAnLi9oZWxwZXJzJztcbmltcG9ydCB7IHV0aWwgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuXG5cbmNvbnN0IERFQlVHR0VSX1RZUEVTID0ge1xuICB3ZWJraXQ6IDEsXG4gIHdlYmluc3BlY3RvcjogMlxufTtcbmNvbnN0IFNFTEVDVF9BUFBfUkVUUklFUyA9IDIwO1xuY29uc3QgUkVNT1RFX0RFQlVHR0VSX1BPUlQgPSAyNzc1MztcblxuLyogSG93IG1hbnkgbWlsbGlzZWNvbmRzIHRvIHdhaXQgZm9yIHdlYmtpdCB0byByZXR1cm4gYSByZXNwb25zZSBiZWZvcmUgdGltaW5nIG91dCAqL1xuY29uc3QgUlBDX1JFU1BPTlNFX1RJTUVPVVRfTVMgPSA1MDAwO1xuXG5jb25zdCBQQUdFX1JFQURZX1RJTUVPVVQgPSA1MDAwO1xuXG5jb25zdCBSRVNQT05TRV9MT0dfTEVOR1RIID0gMTAwO1xuXG5jb25zdCBHQVJCQUdFX0NPTExFQ1RfVElNRU9VVCA9IDUwMDA7XG5cblxuY2xhc3MgUmVtb3RlRGVidWdnZXIgZXh0ZW5kcyBldmVudHMuRXZlbnRFbWl0dGVyIHtcbiAgLypcbiAgICogVGhlIGNvbnN0cnVjdG9yIHRha2VzIGFuIG9wdHMgaGFzaCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAgICogICAtIGJ1bmRsZUlkIC0gaWQgb2YgdGhlIGFwcCBiZWluZyBjb25uZWN0ZWQgdG9cbiAgICogICAtIHBsYXRmb3JtVmVyc2lvbiAtIHZlcnNpb24gb2YgaU9TXG4gICAqICAgLSBkZWJ1Z2dlclR5cGUgLSBvbmUgb2YgdGhlIERFQlVHR0VSX1RZUEVTXG4gICAqICAgLSB1c2VOZXdTYWZhcmkgLSBmb3Igd2ViIGluc3BlY3Rvciwgd2hldGhlciB0aGlzIGlzIGEgbmV3IFNhZmFyaSBpbnN0YW5jZVxuICAgKiAgIC0gcGFnZUxvYWRNcyAtIHRoZSB0aW1lLCBpbiBtcywgdGhhdCBzaG91bGQgYmUgd2FpdGVkIGZvciBwYWdlIGxvYWRpbmdcbiAgICogICAtIGhvc3QgLSB0aGUgcmVtb3RlIGRlYnVnZ2VyJ3MgaG9zdCBhZGRyZXNzXG4gICAqICAgLSBwb3J0IC0gdGhlIHJlbW90ZSBkZWJ1Z2dlciBwb3J0IHRocm91Z2ggd2hpY2ggdG8gY29tbXVuaWNhdGVcbiAgICovXG4gIGNvbnN0cnVjdG9yIChvcHRzID0ge30pIHtcbiAgICBzdXBlcigpO1xuXG4gICAgY29uc3Qge1xuICAgICAgYnVuZGxlSWQsXG4gICAgICBwbGF0Zm9ybVZlcnNpb24sXG4gICAgICBkZWJ1Z2dlclR5cGUgPSBERUJVR0dFUl9UWVBFUy53ZWJpbnNwZWN0b3IsXG4gICAgICBpc1NhZmFyaSA9IHRydWUsXG4gICAgICB1c2VOZXdTYWZhcmkgPSBmYWxzZSxcbiAgICAgIHBhZ2VMb2FkTXMsXG4gICAgICBob3N0LFxuICAgICAgcG9ydCA9IFJFTU9URV9ERUJVR0dFUl9QT1JULFxuICAgICAgc29ja2V0UGF0aCxcbiAgICAgIHBhZ2VSZWFkeVRpbWVvdXQgPSBQQUdFX1JFQURZX1RJTUVPVVQsXG4gICAgICByZW1vdGVEZWJ1Z1Byb3h5LFxuICAgICAgZ2FyYmFnZUNvbGxlY3RPbkV4ZWN1dGUgPSBmYWxzZSxcbiAgICB9ID0gb3B0cztcblxuICAgIHRoaXMuYnVuZGxlSWQgPSBidW5kbGVJZDtcbiAgICB0aGlzLnBsYXRmb3JtVmVyc2lvbiA9IHBsYXRmb3JtVmVyc2lvbjtcbiAgICB0aGlzLmlzU2FmYXJpID0gaXNTYWZhcmk7XG4gICAgdGhpcy5kZWJ1Z2dlclR5cGUgPSBkZWJ1Z2dlclR5cGU7XG4gICAgaWYgKHRoaXMuZGVidWdnZXJUeXBlID09PSBERUJVR0dFUl9UWVBFUy53ZWJpbnNwZWN0b3IpIHtcbiAgICAgIHRoaXMudXNlTmV3U2FmYXJpID0gdXNlTmV3U2FmYXJpO1xuICAgICAgdGhpcy5wYWdlTG9hZE1zID0gcGFnZUxvYWRNcztcbiAgICAgIGxvZy5kZWJ1ZyhgdXNlTmV3U2FmYXJpIC0tPiAke3RoaXMudXNlTmV3U2FmYXJpfWApO1xuICAgIH1cbiAgICB0aGlzLmdhcmJhZ2VDb2xsZWN0T25FeGVjdXRlID0gZ2FyYmFnZUNvbGxlY3RPbkV4ZWN1dGU7XG5cbiAgICB0aGlzLmhvc3QgPSBob3N0O1xuICAgIHRoaXMucG9ydCA9IHBvcnQ7XG4gICAgdGhpcy5zb2NrZXRQYXRoID0gc29ja2V0UGF0aDtcbiAgICB0aGlzLnJlbW90ZURlYnVnUHJveHkgPSByZW1vdGVEZWJ1Z1Byb3h5O1xuICAgIHRoaXMucGFnZVJlYWR5VGltZW91dCA9IHBhZ2VSZWFkeVRpbWVvdXQ7XG4gIH1cblxuICBzZXR1cCAoKSB7XG4gICAgLy8gYXBwIGhhbmRsaW5nIGNvbmZpZ3VyYXRpb25cbiAgICB0aGlzLmFwcERpY3QgPSB7fTtcbiAgICB0aGlzLmFwcElkS2V5ID0gbnVsbDtcbiAgICB0aGlzLnBhZ2VJZEtleSA9IG51bGw7XG4gICAgdGhpcy5wYWdlTG9hZGluZyA9IGZhbHNlO1xuXG4gICAgLy8gc2V0IHVwIHRoZSBzcGVjaWFsIGNhbGxiYWNrcyBmb3IgaGFuZGxpbmcgcmQgZXZlbnRzXG4gICAgdGhpcy5zcGVjaWFsQ2JzID0ge1xuICAgICAgJ19ycGNfcmVwb3J0SWRlbnRpZmllcjonOiBfLm5vb3AsXG4gICAgICAnX3JwY19mb3J3YXJkR2V0TGlzdGluZzonOiB0aGlzLm9uUGFnZUNoYW5nZS5iaW5kKHRoaXMpLFxuICAgICAgJ19ycGNfcmVwb3J0Q29ubmVjdGVkQXBwbGljYXRpb25MaXN0Oic6IF8ubm9vcCxcbiAgICAgICdfcnBjX2FwcGxpY2F0aW9uQ29ubmVjdGVkOic6IHRoaXMub25BcHBDb25uZWN0LmJpbmQodGhpcyksXG4gICAgICAnX3JwY19hcHBsaWNhdGlvbkRpc2Nvbm5lY3RlZDonOiB0aGlzLm9uQXBwRGlzY29ubmVjdC5iaW5kKHRoaXMpLFxuICAgICAgJ19ycGNfYXBwbGljYXRpb25VcGRhdGVkOic6IHRoaXMub25BcHBVcGRhdGUuYmluZCh0aGlzKSxcbiAgICAgICdfcnBjX3JlcG9ydENvbm5lY3RlZERyaXZlckxpc3Q6JzogdGhpcy5vblJlcG9ydERyaXZlckxpc3QuYmluZCh0aGlzKSxcbiAgICAgIHBhZ2VMb2FkOiB0aGlzLnBhZ2VMb2FkLmJpbmQodGhpcyksXG4gICAgICBmcmFtZURldGFjaGVkOiB0aGlzLmZyYW1lRGV0YWNoZWQuYmluZCh0aGlzKSxcbiAgICAgIHRhcmdldENyZWF0ZWQ6IHRoaXMub25UYXJnZXRDcmVhdGVkLmJpbmQodGhpcyksXG4gICAgICB0YXJnZXREZXN0cm95ZWQ6IHRoaXMub25UYXJnZXREZXN0cm95ZWQuYmluZCh0aGlzKSxcbiAgICB9O1xuXG4gICAgdGhpcy5ycGNDbGllbnQgPSBudWxsO1xuICB9XG5cbiAgdGVhcmRvd24gKCkge1xuICAgIGxvZy5kZWJ1ZygnQ2xlYW5pbmcgdXAgbGlzdGVuZXJzJyk7XG5cbiAgICB0aGlzLmFwcERpY3QgPSB7fTtcbiAgICB0aGlzLmFwcElkS2V5ID0gbnVsbDtcbiAgICB0aGlzLnBhZ2VJZEtleSA9IG51bGw7XG4gICAgdGhpcy5wYWdlTG9hZGluZyA9IGZhbHNlO1xuXG4gICAgdGhpcy5zcGVjaWFsQ2JzID0ge307XG5cbiAgICB0aGlzLnJwY0NsaWVudCA9IG51bGw7XG5cbiAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycyhSZW1vdGVEZWJ1Z2dlci5FVkVOVF9QQUdFX0NIQU5HRSk7XG4gICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoUmVtb3RlRGVidWdnZXIuRVZFTlRfRElTQ09OTkVDVCk7XG4gIH1cblxuICBhc3luYyBjb25uZWN0ICgpIHtcbiAgICB0aGlzLnNldHVwKCk7XG5cbiAgICAvLyBpbml0aWFsaXplIHRoZSBycGMgY2xpZW50XG4gICAgdGhpcy5ycGNDbGllbnQgPSBuZXcgUmVtb3RlRGVidWdnZXJScGNDbGllbnQoe1xuICAgICAgcGxhdGZvcm1WZXJzaW9uOiB0aGlzLnBsYXRmb3JtVmVyc2lvbixcbiAgICAgIGlzU2FmYXJpOiB0aGlzLmlzU2FmYXJpLFxuICAgICAgaG9zdDogdGhpcy5ob3N0LFxuICAgICAgcG9ydDogdGhpcy5wb3J0LFxuICAgICAgc29ja2V0UGF0aDogdGhpcy5zb2NrZXRQYXRoLFxuICAgICAgc3BlY2lhbE1lc3NhZ2VIYW5kbGVyczogdGhpcy5zcGVjaWFsQ2JzLFxuICAgICAgbWVzc2FnZVByb3h5OiB0aGlzLnJlbW90ZURlYnVnUHJveHksXG5cbiAgICB9KTtcbiAgICBhd2FpdCB0aGlzLnJwY0NsaWVudC5jb25uZWN0KCk7XG5cbiAgICAvLyBnZXQgdGhlIGNvbm5lY3Rpb24gaW5mb3JtYXRpb24gYWJvdXQgdGhlIGFwcFxuICAgIHRyeSB7XG4gICAgICBsZXQgYXBwSW5mbyA9IGF3YWl0IHRoaXMuc2V0Q29ubmVjdGlvbktleSgpO1xuICAgICAgbG9nLmRlYnVnKCdDb25uZWN0ZWQgdG8gYXBwbGljYXRpb24nKTtcbiAgICAgIHJldHVybiBhcHBJbmZvO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgYXdhaXQgdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICBhc3luYyBkaXNjb25uZWN0ICgpIHtcbiAgICBhd2FpdCB0aGlzLnJwY0NsaWVudC5kaXNjb25uZWN0KCk7XG4gICAgdGhpcy5lbWl0KFJlbW90ZURlYnVnZ2VyLkVWRU5UX0RJU0NPTk5FQ1QsIHRydWUpO1xuICAgIHRoaXMudGVhcmRvd24oKTtcbiAgfVxuXG4gIGlzQ29ubmVjdGVkICgpIHtcbiAgICByZXR1cm4gISEodGhpcy5ycGNDbGllbnQgJiYgdGhpcy5ycGNDbGllbnQuaXNDb25uZWN0ZWQoKSk7XG4gIH1cblxuICBhc3luYyBzZXRDb25uZWN0aW9uS2V5ICgpIHtcbiAgICAvLyBvbmx5IHJlc29sdmUgd2hlbiB0aGUgY29ubmVjdGlvbiByZXNwb25zZSBpcyByZWNlaXZlZFxuICAgIHJldHVybiBhd2FpdCBuZXcgQigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAvLyBsb2NhbCBjYWxsYmFjaywgY2FsbGVkIHdoZW4gdGhlIHJlbW90ZSBkZWJ1Z2dlciBoYXMgZXN0YWJsaXNoZWRcbiAgICAgIC8vIGEgY29ubmVjdGlvbiB0byB0aGUgYXBwIHVuZGVyIHRlc3RcbiAgICAgIC8vIGBhcHBgIHdpbGwgYmUgYW4gYXJyYXkgb2YgZGljdGlvbmFyaWVzIG9mIGFwcCBpbmZvcm1hdGlvblxuICAgICAgbGV0IGNvbm5lY3RDYiA9IChhcHBzKSA9PiB7XG4gICAgICAgIGlmIChfLmlzVW5kZWZpbmVkKGFwcHMpIHx8IF8ua2V5cyhhcHBzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICBsb2cuZGVidWcoJ1JlY2VpdmVkIG5vIGFwcHMgZnJvbSByZW1vdGUgZGVidWdnZXIuIFVuYWJsZSB0byBjb25uZWN0LicpO1xuICAgICAgICAgIHJldHVybiByZXNvbHZlKHRoaXMuYXBwRGljdCk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IG5ld0RpY3QgPSB7fTtcblxuICAgICAgICAvLyB0cmFuc2xhdGUgdGhlIHJlY2VpdmVkIGluZm9ybWF0aW9uIGludG8gYW4gZWFzaWVyLXRvLW1hbmFnZVxuICAgICAgICAvLyBoYXNoIHdpdGggYXBwIGlkIGFzIGtleSwgYW5kIGFwcCBpbmZvIGFzIHZhbHVlXG4gICAgICAgIGZvciAoY29uc3QgZGljdCBvZiBfLnZhbHVlcyhhcHBzKSkge1xuICAgICAgICAgIGxldCBbaWQsIGVudHJ5XSA9IGFwcEluZm9Gcm9tRGljdChkaWN0KTtcbiAgICAgICAgICBuZXdEaWN0W2lkXSA9IGVudHJ5O1xuICAgICAgICB9XG4gICAgICAgIC8vIHVwZGF0ZSB0aGUgb2JqZWN0J3MgbGlzdCBvZiBhcHBzLCBhbmQgcmV0dXJuIGl0IHRocm91Z2ggdGhlIHByb21pc2VcbiAgICAgICAgXy5kZWZhdWx0cyh0aGlzLmFwcERpY3QsIG5ld0RpY3QpO1xuICAgICAgICByZXNvbHZlKG5ld0RpY3QpO1xuICAgICAgfTtcbiAgICAgIHRoaXMucnBjQ2xpZW50LnNldFNwZWNpYWxNZXNzYWdlSGFuZGxlcignX3JwY19yZXBvcnRDb25uZWN0ZWRBcHBsaWNhdGlvbkxpc3Q6JywgcmVqZWN0LCBjb25uZWN0Q2IpO1xuXG4gICAgICBsb2cuZGVidWcoJ1NlbmRpbmcgY29ubmVjdGlvbiBrZXkgcmVxdWVzdCcpO1xuICAgICAgcmV0dXJuIChhc3luYyAoKSA9PiB7XG4gICAgICAgIGxldCBbc2ltTmFtZUtleSwgc2ltQnVpbGRLZXksIHNpbVBsYXRmb3JtVmVyc2lvbl0gPSBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZW5kKCdzZXRDb25uZWN0aW9uS2V5Jyk7XG4gICAgICAgIGxvZy5kZWJ1ZyhgU2ltIG5hbWU6ICR7c2ltTmFtZUtleX1gKTtcbiAgICAgICAgbG9nLmRlYnVnKGBTaW0gYnVpbGQ6ICR7c2ltQnVpbGRLZXl9YCk7XG4gICAgICAgIGxvZy5kZWJ1ZyhgU2ltIHBsYXRmb3JtIHZlcnNpb246ICR7c2ltUGxhdGZvcm1WZXJzaW9ufWApO1xuICAgICAgfSkoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZUFwcHNXaXRoRGljdCAoZGljdCkge1xuICAgIC8vIGdldCB0aGUgZGljdGlvbmFyeSBlbnRyeSBpbnRvIGEgbmljZSBmb3JtLCBhbmQgYWRkIGl0IHRvIHRoZVxuICAgIC8vIGFwcGxpY2F0aW9uIGRpY3Rpb25hcnlcbiAgICB0aGlzLmFwcERpY3QgPSB0aGlzLmFwcERpY3QgfHwge307XG4gICAgbGV0IFtpZCwgZW50cnldID0gYXBwSW5mb0Zyb21EaWN0KGRpY3QpO1xuICAgIGlmICh0aGlzLmFwcERpY3RbaWRdKSB7XG4gICAgICAvLyBwcmVzZXJ2ZSB0aGUgcGFnZSBkaWN0aW9uYXJ5IGZvciB0aGlzIGVudHJ5XG4gICAgICBlbnRyeS5wYWdlQXJyYXkgPSB0aGlzLmFwcERpY3RbaWRdLnBhZ2VBcnJheTtcbiAgICB9XG4gICAgdGhpcy5hcHBEaWN0W2lkXSA9IGVudHJ5O1xuXG4gICAgLy8gYWRkIGEgcHJvbWlzZSB0byBnZXQgdGhlIHBhZ2UgZGljdGlvbmFyeVxuICAgIGlmIChfLmlzVW5kZWZpbmVkKGVudHJ5LnBhZ2VBcnJheSkpIHtcbiAgICAgIGVudHJ5LnBhZ2VBcnJheSA9IGRlZmVycmVkUHJvbWlzZSgpO1xuICAgIH1cblxuICAgIC8vIHRyeSB0byBnZXQgdGhlIGFwcCBpZCBmcm9tIG91ciBjb25uZWN0ZWQgYXBwc1xuICAgIGlmICghdGhpcy5hcHBJZEtleSkge1xuICAgICAgdGhpcy5hcHBJZEtleSA9IGdldERlYnVnZ2VyQXBwS2V5KHRoaXMuYnVuZGxlSWQsIHRoaXMucGxhdGZvcm1WZXJzaW9uLCB0aGlzLmFwcERpY3QpO1xuICAgIH1cbiAgfVxuXG4gIGxvZ0FwcGxpY2F0aW9uRGljdGlvbmFyeSAoYXBwcykge1xuICAgIGZ1bmN0aW9uIGdldFZhbHVlU3RyaW5nIChrZXksIHZhbHVlKSB7XG4gICAgICBpZiAoXy5pc0Z1bmN0aW9uKHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gJ1tGdW5jdGlvbl0nO1xuICAgICAgfVxuICAgICAgaWYgKGtleSA9PT0gJ3BhZ2VEaWN0JyAmJiAhXy5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gYCdXYWl0aW5nIGZvciBkYXRhJ2A7XG4gICAgICB9XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xuICAgIH1cbiAgICBsb2cuZGVidWcoJ0N1cnJlbnQgYXBwbGljYXRpb25zIGF2YWlsYWJsZTonKTtcbiAgICBmb3IgKGNvbnN0IFthcHAsIGluZm9dIG9mIF8udG9QYWlycyhhcHBzKSkge1xuICAgICAgbG9nLmRlYnVnKGAgICAgQXBwbGljYXRpb246ICcke2FwcH0nYCk7XG4gICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBfLnRvUGFpcnMoaW5mbykpIHtcbiAgICAgICAgY29uc3QgdmFsdWVTdHJpbmcgPSBnZXRWYWx1ZVN0cmluZyhrZXksIHZhbHVlKTtcbiAgICAgICAgbG9nLmRlYnVnKGAgICAgICAgICR7a2V5fTogJHt2YWx1ZVN0cmluZ31gKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBzZWxlY3RBcHAgKGN1cnJlbnRVcmwgPSBudWxsLCBtYXhUcmllcyA9IFNFTEVDVF9BUFBfUkVUUklFUywgaWdub3JlQWJvdXRCbGFua1VybCA9IGZhbHNlKSB7XG4gICAgbG9nLmRlYnVnKCdTZWxlY3RpbmcgYXBwbGljYXRpb24nKTtcbiAgICBpZiAoIXRoaXMuYXBwRGljdCB8fCBfLmtleXModGhpcy5hcHBEaWN0KS5sZW5ndGggPT09IDApIHtcbiAgICAgIGxvZy5kZWJ1ZygnTm8gYXBwbGljYXRpb25zIGN1cnJlbnRseSBjb25uZWN0ZWQuJyk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgLy8gaXRlcmF0aXZlIHNvbHV0aW9uLCBhcyByZWN1cnNpb24gd2FzIHN3YWxsb3dpbmcgdGhlIHByb21pc2UgYXQgc29tZSBwb2ludFxuICAgIGxldCBwYWdlRGljdCwgYXBwSWRLZXk7XG4gICAgYXBwTG9vcDogZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhUcmllczsgaSsrKSB7XG4gICAgICB0aGlzLmxvZ0FwcGxpY2F0aW9uRGljdGlvbmFyeSh0aGlzLmFwcERpY3QpO1xuICAgICAgbGV0IHBvc3NpYmxlQXBwSWRzID0gZ2V0UG9zc2libGVEZWJ1Z2dlckFwcEtleXModGhpcy5idW5kbGVJZCwgdGhpcy5wbGF0Zm9ybVZlcnNpb24sIHRoaXMuYXBwRGljdCk7XG4gICAgICBsb2cuZGVidWcoYFRyeWluZyBvdXQgdGhlIHBvc3NpYmxlIGFwcCBpZHM6ICR7cG9zc2libGVBcHBJZHMuam9pbignLCAnKX1gKTtcbiAgICAgIGZvciAoY29uc3QgYXR0ZW1wdGVkQXBwSWRLZXkgb2YgcG9zc2libGVBcHBJZHMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBsb2cuZGVidWcoYFNlbGVjdGluZyBhcHAgJHthdHRlbXB0ZWRBcHBJZEtleX0gKHRyeSAjJHtpICsgMX0gb2YgJHttYXhUcmllc30pYCk7XG4gICAgICAgICAgW2FwcElkS2V5LCBwYWdlRGljdF0gPSBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZWxlY3RBcHAoYXR0ZW1wdGVkQXBwSWRLZXksIHRoaXMub25BcHBDb25uZWN0LmJpbmQodGhpcykpO1xuICAgICAgICAgIC8vIGluIGlPUyA4LjIgdGhlIGNvbm5lY3QgbG9naWMgaGFwcGVucywgYnV0IHdpdGggYW4gZW1wdHkgZGljdGlvbmFyeVxuICAgICAgICAgIC8vIHdoaWNoIGxlYWRzIHRvIHRoZSByZW1vdGUgZGVidWdnZXIgZ2V0dGluZyBkaXNjb25uZWN0ZWQsIGFuZCBpbnRvIGEgbG9vcFxuICAgICAgICAgIGlmIChfLmlzRW1wdHkocGFnZURpY3QpKSB7XG4gICAgICAgICAgICBsb2cuZGVidWcoJ0VtcHR5IHBhZ2UgZGljdGlvbmFyeSByZWNlaXZlZC4gVHJ5aW5nIGFnYWluLicpO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gc2F2ZSB0aGUgcGFnZSBhcnJheSBmb3IgdGhpcyBhcHBcbiAgICAgICAgICB0aGlzLmFwcERpY3RbYXBwSWRLZXldLnBhZ2VBcnJheSA9IHBhZ2VBcnJheUZyb21EaWN0KHBhZ2VEaWN0KTtcblxuICAgICAgICAgIC8vIGlmIHdlIGFyZSBsb29raW5nIGZvciBhIHBhcnRpY3VsYXIgdXJsLCBtYWtlIHN1cmUgd2UgaGF2ZSB0aGUgcmlnaHQgcGFnZS4gSWdub3JlIGVtcHR5IG9yIHVuZGVmaW5lZCB1cmxzLiBJZ25vcmUgYWJvdXQ6YmxhbmsgaWYgcmVxdWVzdGVkLlxuICAgICAgICAgIGxldCBmb3VuZCA9IGZhbHNlO1xuICAgICAgICAgIGRpY3RMb29wOiBmb3IgKGNvbnN0IGFwcERpY3Qgb2YgXy52YWx1ZXModGhpcy5hcHBEaWN0KSkge1xuICAgICAgICAgICAgaWYgKGZvdW5kKSBicmVhazsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuXG4gICAgICAgICAgICBpZiAoIWFwcERpY3QgfHwgIWFwcERpY3QucGFnZUFycmF5KSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpZiB0aGUgcGFnZSBkaWN0aW9uYXJ5IGhhcyBub3QgYmVlbiBsb2FkZWQgeWV0IGZyb20gdGhlIHdlYlxuICAgICAgICAgICAgLy8gaW5zcGVjdG9yLCB3YWl0IGZvciBpdCBvciB0aW1lIG91dCBhZnRlciAxMHNcbiAgICAgICAgICAgIGlmIChhcHBEaWN0LnBhZ2VBcnJheS5wcm9taXNlKSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgQi5yZXNvbHZlKGFwcERpY3QucGFnZUFycmF5LnByb21pc2UpLnRpbWVvdXQoMTAwMDApO1xuICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBCLlRpbWVvdXRFcnJvcikpIHtcbiAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gb24gdGltZW91dCwganVzdCBnbyBvblxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgZGljdCBvZiAoYXBwRGljdC5wYWdlQXJyYXkgfHwgW10pKSB7XG4gICAgICAgICAgICAgIGlmICgoIWlnbm9yZUFib3V0QmxhbmtVcmwgfHwgZGljdC51cmwgIT09ICdhYm91dDpibGFuaycpICYmICghY3VycmVudFVybCB8fCBkaWN0LnVybCA9PT0gY3VycmVudFVybCkpIHtcbiAgICAgICAgICAgICAgICAvLyBzYXZlIHdoZXJlIHdlIGZvdW5kIHRoZSByaWdodCBwYWdlXG4gICAgICAgICAgICAgICAgYXBwSWRLZXkgPSBhcHBEaWN0LmlkO1xuICAgICAgICAgICAgICAgIHBhZ2VEaWN0ID0gZGljdDtcbiAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWsgZGljdExvb3A7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFmb3VuZCkge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRVcmwpIHtcbiAgICAgICAgICAgICAgbG9nLmRlYnVnKGBSZWNlaXZlZCBhcHAsIGJ1dCBleHBlY3RlZCB1cmwgKCcke2N1cnJlbnRVcmx9Jykgd2FzIG5vdCBmb3VuZC4gVHJ5aW5nIGFnYWluLmApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbG9nLmRlYnVnKCdSZWNlaXZlZCBhcHAsIGJ1dCBubyBtYXRjaCB3YXMgZm91bmQuIFRyeWluZyBhZ2Fpbi4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhZ2VEaWN0ID0gbnVsbDtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIHdlIGhhdmUgZ290dGVuIHRoZSBjb3JyZWN0IGFwcGxpY2F0aW9uIGJ5IHRoaXMgcG9pbnQsIHNvIHNob3J0IGNpcmN1aXQgZXZlcnl0aGluZ1xuICAgICAgICAgIGJyZWFrIGFwcExvb3A7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGxvZy5kZWJ1ZyhgRXJyb3IgY2hlY2tpbmcgYXBwbGljYXRpb246ICcke2Vyci5tZXNzYWdlfScuIFJldHJ5aW5nIGNvbm5lY3Rpb25gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGlmLCBhZnRlciBhbGwgdGhpcywgd2UgaGF2ZSBubyBkaWN0aW9uYXJ5LCB3ZSBoYXZlIGZhaWxlZFxuICAgIGlmICghcGFnZURpY3QpIHtcbiAgICAgIGxvZy5lcnJvckFuZFRocm93KGBDb3VsZCBub3QgY29ubmVjdCB0byBhIHZhbGlkIGFwcCBhZnRlciAke21heFRyaWVzfSB0cmllcy5gKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5hcHBJZEtleSAhPT0gYXBwSWRLZXkpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgUmVjZWl2ZWQgYWx0ZXJlZCBhcHAgaWQsIHVwZGF0aW5nIGZyb20gJyR7dGhpcy5hcHBJZEtleX0nIHRvICcke2FwcElkS2V5fSdgKTtcbiAgICAgIHRoaXMuYXBwSWRLZXkgPSBhcHBJZEtleTtcbiAgICB9XG5cbiAgICAvLyB3YWl0IGZvciBhbGwgdGhlIHByb21pc2VzIGFyZSBiYWNrLCBvciAzMHMgcGFzc2VzXG4gICAgY29uc3QgcGFnZVByb21pc2VzID0gT2JqZWN0LnZhbHVlcyh0aGlzLmFwcERpY3QpXG4gICAgICAuZmlsdGVyKChhcHApID0+ICEhYXBwLnBhZ2VBcnJheSAmJiAhIWFwcC5wYWdlQXJyYXkucHJvbWlzZSlcbiAgICAgIC5tYXAoKGFwcCkgPT4gYXBwLnBhZ2VBcnJheS5wcm9taXNlKTtcbiAgICBpZiAocGFnZVByb21pc2VzLmxlbmd0aCkge1xuICAgICAgbG9nLmRlYnVnKGBXYWl0aW5nIGZvciAke3BhZ2VQcm9taXNlcy5sZW5ndGh9IHBhZ2VzIHRvIGJlIGZ1bGZpbGxlZGApO1xuICAgICAgYXdhaXQgQi5hbnkoW0IuZGVsYXkoMzAwMDApLCBCLmFsbChwYWdlUHJvbWlzZXMpXSk7XG4gICAgfVxuXG4gICAgLy8gdHJhbnNsYXRlIHRoZSBkaWN0aW9uYXJ5IGludG8gYSB1c2VmdWwgZm9ybSwgYW5kIHJldHVybiB0byBzZW5kZXJcbiAgICBjb25zdCBwYWdlQXJyYXkgPSBfLmlzRW1wdHkodGhpcy5hcHBEaWN0W2FwcElkS2V5XS5wYWdlQXJyYXkpXG4gICAgICA/IHBhZ2VBcnJheUZyb21EaWN0KHBhZ2VEaWN0KVxuICAgICAgOiB0aGlzLmFwcERpY3RbYXBwSWRLZXldLnBhZ2VBcnJheTtcbiAgICBsb2cuZGVidWcoYEZpbmFsbHkgc2VsZWN0aW5nIGFwcCAke3RoaXMuYXBwSWRLZXl9OiAke3NpbXBsZVN0cmluZ2lmeShwYWdlQXJyYXkpfWApO1xuXG4gICAgbGV0IGZ1bGxQYWdlQXJyYXkgPSBbXTtcbiAgICBmb3IgKGNvbnN0IFthcHAsIGluZm9dIG9mIF8udG9QYWlycyh0aGlzLmFwcERpY3QpKSB7XG4gICAgICBpZiAoIV8uaXNBcnJheShpbmZvLnBhZ2VBcnJheSkpIGNvbnRpbnVlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGN1cmx5XG4gICAgICBsZXQgaWQgPSBhcHAucmVwbGFjZSgnUElEOicsICcnKTtcbiAgICAgIGZvciAoY29uc3QgcGFnZSBvZiBpbmZvLnBhZ2VBcnJheSkge1xuICAgICAgICBpZiAocGFnZS51cmwgJiYgKCFpZ25vcmVBYm91dEJsYW5rVXJsIHx8IHBhZ2UudXJsICE9PSAnYWJvdXQ6YmxhbmsnKSAmJiAoIWN1cnJlbnRVcmwgfHwgcGFnZS51cmwgPT09IGN1cnJlbnRVcmwpKSB7XG4gICAgICAgICAgbGV0IHBhZ2VEaWN0ID0gXy5jbG9uZShwYWdlKTtcbiAgICAgICAgICBwYWdlRGljdC5pZCA9IGAke2lkfS4ke3BhZ2VEaWN0LmlkfWA7XG4gICAgICAgICAgZnVsbFBhZ2VBcnJheS5wdXNoKHBhZ2VEaWN0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmdWxsUGFnZUFycmF5O1xuICB9XG5cbiAgYXN5bmMgc2VsZWN0UGFnZSAoYXBwSWRLZXksIHBhZ2VJZEtleSwgc2tpcFJlYWR5Q2hlY2sgPSBmYWxzZSkge1xuICAgIHRoaXMuYXBwSWRLZXkgPSBgUElEOiR7YXBwSWRLZXl9YDtcbiAgICB0aGlzLnBhZ2VJZEtleSA9IHBhZ2VJZEtleTtcblxuICAgIGxvZy5kZWJ1ZyhgU2VsZWN0aW5nIHBhZ2UgJyR7cGFnZUlkS2V5fScgb24gYXBwICcke3RoaXMuYXBwSWRLZXl9JyBhbmQgZm9yd2FyZGluZyBzb2NrZXQgc2V0dXBgKTtcblxuICAgIGF3YWl0IHRoaXMucnBjQ2xpZW50LnNlbmQoJ3NldFNlbmRlcktleScsIHtcbiAgICAgIGFwcElkS2V5OiB0aGlzLmFwcElkS2V5LFxuICAgICAgcGFnZUlkS2V5OiB0aGlzLnBhZ2VJZEtleVxuICAgIH0pO1xuICAgIGxvZy5kZWJ1ZygnU2VuZGVyIGtleSBzZXQnKTtcblxuICAgIGF3YWl0IHRoaXMucnBjQ2xpZW50LnNlbmQoJ2VuYWJsZVBhZ2UnLCB7XG4gICAgICBhcHBJZEtleTogdGhpcy5hcHBJZEtleSxcbiAgICAgIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXksXG4gICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlLFxuICAgICAgdGFyZ2V0SWQ6ICdwYWdlLTEnLFxuICAgIH0pO1xuICAgIGxvZy5kZWJ1ZygnRW5hYmxlZCBhY3Rpdml0eSBvbiBwYWdlJyk7XG5cbiAgICAvLyBtYWtlIHN1cmUgZXZlcnl0aGluZyBpcyByZWFkeSB0byBnb1xuICAgIGlmICghc2tpcFJlYWR5Q2hlY2sgJiYgIWF3YWl0IHRoaXMuY2hlY2tQYWdlSXNSZWFkeSgpKSB7XG4gICAgICBhd2FpdCB0aGlzLnBhZ2VVbmxvYWQoKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBleGVjdXRlQXRvbSAoYXRvbSwgYXJncywgZnJhbWVzKSB7XG4gICAgaWYgKCF0aGlzLnJwY0NsaWVudC5jb25uZWN0ZWQpIHRocm93IG5ldyBFcnJvcignUmVtb3RlIGRlYnVnZ2VyIGlzIG5vdCBjb25uZWN0ZWQnKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuXG4gICAgbG9nLmRlYnVnKGBFeGVjdXRpbmcgYXRvbSAnJHthdG9tfSdgKTtcbiAgICBjb25zdCBzY3JpcHQgPSBhd2FpdCBnZXRTY3JpcHRGb3JBdG9tKGF0b20sIGFyZ3MsIGZyYW1lcyk7XG4gICAgY29uc3QgdmFsdWUgPSBhd2FpdCB0aGlzLmV4ZWN1dGUoc2NyaXB0LCB0cnVlKTtcbiAgICBsb2cuZGVidWcoYFJlY2VpdmVkIHJlc3VsdCBmb3IgYXRvbSAnJHthdG9tfScgZXhlY3V0aW9uOiAke18udHJ1bmNhdGUoc2ltcGxlU3RyaW5naWZ5KHZhbHVlKSwge2xlbmd0aDogUkVTUE9OU0VfTE9HX0xFTkdUSH0pfWApO1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIGFzeW5jIGV4ZWN1dGVBdG9tQXN5bmMgKGF0b20sIGFyZ3MsIGZyYW1lcywgcmVzcG9uc2VVcmwpIHtcbiAgICBsZXQgYXN5bmNDYWxsQmFjayA9IGBmdW5jdGlvbiAocmVzKSB7IHhtbEh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsgYCArXG4gICAgICAgICAgICAgICAgICAgICAgICBgeG1sSHR0cC5vcGVuKCdQT1NUJywgJyR7cmVzcG9uc2VVcmx9JywgdHJ1ZSk7YCArXG4gICAgICAgICAgICAgICAgICAgICAgICBgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LXR5cGUnLCdhcHBsaWNhdGlvbi9qc29uJyk7IGAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgYHhtbEh0dHAuc2VuZChyZXMpOyB9YDtcbiAgICBsZXQgc2NyaXB0ID0gYXdhaXQgZ2V0U2NyaXB0Rm9yQXRvbShhdG9tLCBhcmdzLCBmcmFtZXMsIGFzeW5jQ2FsbEJhY2spO1xuICAgIGF3YWl0IHRoaXMuZXhlY3V0ZShzY3JpcHQpO1xuICB9XG5cbiAgZnJhbWVEZXRhY2hlZCAoKSB7XG4gICAgdGhpcy5lbWl0KFJlbW90ZURlYnVnZ2VyLkVWRU5UX0ZSQU1FU19ERVRBQ0hFRCk7XG4gIH1cblxuICBhc3luYyBwYWdlTG9hZCAoc3RhcnRQYWdlTG9hZE1zLCBwYWdlTG9hZFZlcmlmeUhvb2spIHtcbiAgICBsZXQgdGltZW91dE1zID0gNTAwO1xuICAgIGxldCBzdGFydCA9IHN0YXJ0UGFnZUxvYWRNcyB8fCBEYXRlLm5vdygpO1xuICAgIGxvZy5kZWJ1ZygnUGFnZSBsb2FkZWQsIHZlcmlmeWluZyB3aGV0aGVyIHJlYWR5Jyk7XG5cbiAgICBjb25zdCB2ZXJpZnkgPSBhc3luYyAoKSA9PiB7XG4gICAgICB0aGlzLnBhZ2VMb2FkRGVsYXkgPSB1dGlsLmNhbmNlbGxhYmxlRGVsYXkodGltZW91dE1zKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHRoaXMucGFnZUxvYWREZWxheTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgQi5DYW5jZWxsYXRpb25FcnJvcikge1xuICAgICAgICAgIC8vIGlmIHRoZSBwcm9taXNlIGhhcyBiZWVuIGNhbmNlbGxlZFxuICAgICAgICAgIC8vIHdlIHdhbnQgdG8gc2tpcCBjaGVja2luZyB0aGUgcmVhZGluZXNzXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIHdlIGNhbiBnZXQgdGhpcyBjYWxsZWQgaW4gdGhlIG1pZGRsZSBvZiB0cnlpbmcgdG8gZmluZCBhIG5ldyBhcHBcbiAgICAgIGlmICghdGhpcy5hcHBJZEtleSkge1xuICAgICAgICBsb2cuZGVidWcoJ05vdCBjb25uZWN0ZWQgdG8gYW4gYXBwbGljYXRpb24uIElnbm9yaW5nIHBhZ2UgbG9hZCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChfLmlzRnVuY3Rpb24ocGFnZUxvYWRWZXJpZnlIb29rKSkge1xuICAgICAgICBhd2FpdCBwYWdlTG9hZFZlcmlmeUhvb2soKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVhZHkgPSBhd2FpdCB0aGlzLmNoZWNrUGFnZUlzUmVhZHkoKTtcblxuICAgICAgLy8gaWYgd2UgYXJlIHJlYWR5LCBvciB3ZSd2ZSBzcGVuZCB0b28gbXVjaCB0aW1lIG9uIHRoaXNcbiAgICAgIGlmIChyZWFkeSB8fCAodGhpcy5wYWdlTG9hZE1zID4gMCAmJiAoc3RhcnQgKyB0aGlzLnBhZ2VMb2FkTXMpIDwgRGF0ZS5ub3coKSkpIHtcbiAgICAgICAgbG9nLmRlYnVnKCdQYWdlIGlzIHJlYWR5Jyk7XG4gICAgICAgIHRoaXMucGFnZUxvYWRpbmcgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy5kZWJ1ZygnUGFnZSB3YXMgbm90IHJlYWR5LCByZXRyeWluZycpO1xuICAgICAgICBhd2FpdCB2ZXJpZnkoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGF3YWl0IHZlcmlmeSgpO1xuICB9XG5cbiAgY2FuY2VsUGFnZUxvYWQgKCkge1xuICAgIGxvZy5kZWJ1ZygnVW5yZWdpc3RlcmluZyBmcm9tIHBhZ2UgcmVhZGluZXNzIG5vdGlmaWNhdGlvbnMnKTtcbiAgICB0aGlzLnBhZ2VMb2FkaW5nID0gZmFsc2U7XG4gICAgaWYgKHRoaXMucGFnZUxvYWREZWxheSkge1xuICAgICAgdGhpcy5wYWdlTG9hZERlbGF5LmNhbmNlbCgpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHBhZ2VVbmxvYWQgKCkge1xuICAgIGxvZy5kZWJ1ZygnUGFnZSB1bmxvYWRpbmcnKTtcbiAgICB0aGlzLnBhZ2VMb2FkaW5nID0gdHJ1ZTtcbiAgICBhd2FpdCB0aGlzLndhaXRGb3JEb20oKTtcbiAgfVxuXG4gIGFzeW5jIHdhaXRGb3JEb20gKHN0YXJ0UGFnZUxvYWRNcywgcGFnZUxvYWRWZXJpZnlIb29rKSB7XG4gICAgbG9nLmRlYnVnKCdXYWl0aW5nIGZvciBkb20uLi4nKTtcbiAgICBhd2FpdCB0aGlzLnBhZ2VMb2FkKHN0YXJ0UGFnZUxvYWRNcywgcGFnZUxvYWRWZXJpZnlIb29rKTtcbiAgfVxuXG4gIGFzeW5jIGNoZWNrUGFnZUlzUmVhZHkgKCkge1xuICAgIGNvbnN0IGVycm9ycyA9IGNoZWNrUGFyYW1zKHthcHBJZEtleTogdGhpcy5hcHBJZEtleX0pO1xuICAgIGlmIChlcnJvcnMpIHRocm93IG5ldyBFcnJvcihlcnJvcnMpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGN1cmx5XG5cbiAgICBsb2cuZGVidWcoJ0NoZWNraW5nIGRvY3VtZW50IHJlYWR5U3RhdGUnKTtcbiAgICBjb25zdCByZWFkeUNtZCA9ICcoZnVuY3Rpb24gKCl7IHJldHVybiBkb2N1bWVudC5yZWFkeVN0YXRlOyB9KSgpJztcbiAgICBsZXQgcmVhZHlTdGF0ZSA9ICdsb2FkaW5nJztcbiAgICB0cnkge1xuICAgICAgcmVhZHlTdGF0ZSA9IGF3YWl0IEIucmVzb2x2ZSh0aGlzLmV4ZWN1dGUocmVhZHlDbWQsIHRydWUpKS50aW1lb3V0KHRoaXMucGFnZVJlYWR5VGltZW91dCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBCLlRpbWVvdXRFcnJvcikpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgICAgbG9nLmRlYnVnKGBQYWdlIHJlYWRpbmVzcyBjaGVjayB0aW1lZCBvdXQgYWZ0ZXIgJHt0aGlzLnBhZ2VSZWFkeVRpbWVvdXR9bXNgKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbG9nLmRlYnVnKGBEb2N1bWVudCByZWFkeVN0YXRlIGlzICcke3JlYWR5U3RhdGV9J2ApO1xuXG4gICAgcmV0dXJuIHJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZSc7XG4gIH1cblxuICBhc3luYyBuYXZUb1VybCAodXJsLCBwYWdlTG9hZFZlcmlmeUhvb2spIHtcbiAgICAvLyBubyBuZWVkIHRvIGRvIHRoaXMgY2hlY2sgd2hlbiB1c2luZyB3ZWJraXRcbiAgICBpZiAodGhpcy5kZWJ1Z2dlclR5cGUgPT09IERFQlVHR0VSX1RZUEVTLndlYmluc3BlY3Rvcikge1xuICAgICAgbGV0IGVycm9ycyA9IGNoZWNrUGFyYW1zKHthcHBJZEtleTogdGhpcy5hcHBJZEtleSwgcGFnZUlkS2V5OiB0aGlzLnBhZ2VJZEtleX0pO1xuICAgICAgaWYgKGVycm9ycykgdGhyb3cgbmV3IEVycm9yKGVycm9ycyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgY3VybHlcbiAgICB9XG5cbiAgICBsb2cuZGVidWcoYE5hdmlnYXRpbmcgdG8gbmV3IFVSTDogJHt1cmx9YCk7XG4gICAgYXdhaXQgdGhpcy5ycGNDbGllbnQuc2VuZCgnc2V0VXJsJywge1xuICAgICAgdXJsLFxuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgICAgZGVidWdnZXJUeXBlOiB0aGlzLmRlYnVnZ2VyVHlwZVxuICAgIH0pO1xuXG4gICAgaWYgKCF0aGlzLnVzZU5ld1NhZmFyaSkge1xuICAgICAgLy8gYSBzbWFsbCBwYXVzZSBmb3IgdGhlIGJyb3dzZXIgdG8gY2F0Y2ggdXBcbiAgICAgIGF3YWl0IEIuZGVsYXkoMTAwMCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGVidWdnZXJUeXBlID09PSBERUJVR0dFUl9UWVBFUy53ZWJpbnNwZWN0b3IpIHtcbiAgICAgIGF3YWl0IHRoaXMud2FpdEZvckZyYW1lTmF2aWdhdGVkKCk7XG4gICAgfVxuICAgIGF3YWl0IHRoaXMud2FpdEZvckRvbShEYXRlLm5vdygpLCBwYWdlTG9hZFZlcmlmeUhvb2spO1xuICB9XG5cbiAgYXN5bmMgd2FpdEZvckZyYW1lTmF2aWdhdGVkICgpIHtcbiAgICByZXR1cm4gYXdhaXQgbmV3IEIoYXN5bmMgKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgbG9nLmRlYnVnKCdXYWl0aW5nIGZvciBmcmFtZSBuYXZpZ2F0ZWQgbWVzc2FnZS4uLicpO1xuICAgICAgbGV0IHN0YXJ0TXMgPSBEYXRlLm5vdygpO1xuXG4gICAgICAvLyBhZGQgYSBoYW5kbGVyIGZvciB0aGUgYFBhZ2UuZnJhbWVOYXZpZ2F0ZWRgIG1lc3NhZ2VcbiAgICAgIC8vIGZyb20gdGhlIHJlbW90ZSBkZWJ1Z2dlclxuICAgICAgbGV0IG5hdkV2ZW50TGlzdGVuZXIgPSAodmFsdWUpID0+IHtcbiAgICAgICAgbG9nLmRlYnVnKGBGcmFtZSBuYXZpZ2F0ZWQgaW4gJHsoKERhdGUubm93KCkgLSBzdGFydE1zKSAvIDEwMDApfSBzZWMgZnJvbSBzb3VyY2U6ICR7dmFsdWV9YCk7XG4gICAgICAgIGlmICh0aGlzLm5hdmlnYXRpb25EZWxheSkge1xuICAgICAgICAgIHRoaXMubmF2aWdhdGlvbkRlbGF5LmNhbmNlbCgpO1xuICAgICAgICB9XG4gICAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgICAgfTtcbiAgICAgIHRoaXMucnBjQ2xpZW50LnNldFNwZWNpYWxNZXNzYWdlSGFuZGxlcignUGFnZS5mcmFtZU5hdmlnYXRlZCcsIHJlamVjdCwgbmF2RXZlbnRMaXN0ZW5lcik7XG5cbiAgICAgIC8vIHRpbWVvdXQsIGluIGNhc2UgcmVtb3RlIGRlYnVnZ2VyIGRvZXNuJ3QgcmVzcG9uZCxcbiAgICAgIC8vIG9yIHRha2VzIGEgbG9uZyB0aW1lXG4gICAgICBpZiAoIXRoaXMudXNlTmV3U2FmYXJpIHx8IHRoaXMucGFnZUxvYWRNcyA+PSAwKSB7XG4gICAgICAgIC8vIHVzZSBwYWdlTG9hZE1zLCBvciBhIHNtYWxsIGFtb3VudCBvZiB0aW1lXG4gICAgICAgIGxldCB0aW1lb3V0ID0gdGhpcy51c2VOZXdTYWZhcmkgPyB0aGlzLnBhZ2VMb2FkTXMgOiA1MDA7XG4gICAgICAgIHRoaXMubmF2aWdhdGlvbkRlbGF5ID0gdXRpbC5jYW5jZWxsYWJsZURlbGF5KHRpbWVvdXQpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHRoaXMubmF2aWdhdGlvbkRlbGF5O1xuICAgICAgICAgIG5hdkV2ZW50TGlzdGVuZXIoJ3RpbWVvdXQnKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgLy8gbm90aGluZyB0byBkbzogd2Ugb25seSBnZXQgaGVyZSBpZiB0aGUgcmVtb3RlIGRlYnVnZ2VyXG4gICAgICAgICAgLy8gYWxyZWFkeSBub3RpZmllZCBvZiBmcmFtZSBuYXZpZ2F0aW9uLCBhbmQgdGhlIGRlbGF5XG4gICAgICAgICAgLy8gd2FzIGNhbmNlbGxlZFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBzdGFydFRpbWVsaW5lIChmbikge1xuICAgIGxvZy5kZWJ1ZygnU3RhcnRpbmcgdG8gcmVjb3JkIHRoZSB0aW1lbGluZScpO1xuICAgIHRoaXMucnBjQ2xpZW50LnNldFRpbWVsaW5lRXZlbnRIYW5kbGVyKGZuKTtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5ycGNDbGllbnQuc2VuZCgnc3RhcnRUaW1lbGluZScsIHtcbiAgICAgIGFwcElkS2V5OiB0aGlzLmFwcElkS2V5LFxuICAgICAgcGFnZUlkS2V5OiB0aGlzLnBhZ2VJZEtleSxcbiAgICAgIGRlYnVnZ2VyVHlwZTogdGhpcy5kZWJ1Z2dlclR5cGVcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHN0b3BUaW1lbGluZSAoKSB7XG4gICAgbG9nLmRlYnVnKCdTdG9wcGluZyB0byByZWNvcmQgdGhlIHRpbWVsaW5lJyk7XG4gICAgYXdhaXQgdGhpcy5ycGNDbGllbnQuc2VuZCgnc3RvcFRpbWVsaW5lJywge1xuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgICAgZGVidWdnZXJUeXBlOiB0aGlzLmRlYnVnZ2VyVHlwZVxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgc3RhcnRDb25zb2xlIChmbikge1xuICAgIGxvZy5kZWJ1ZygnU3RhcnRpbmcgdG8gbGlzdGVuIGZvciBKYXZhU2NyaXB0IGNvbnNvbGUnKTtcbiAgICB0aGlzLnJwY0NsaWVudC5zZXRDb25zb2xlTG9nRXZlbnRIYW5kbGVyKGZuKTtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5ycGNDbGllbnQuc2VuZCgnc3RhcnRDb25zb2xlJywge1xuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgICAgZGVidWdnZXJUeXBlOiB0aGlzLmRlYnVnZ2VyVHlwZVxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgc3RvcENvbnNvbGUgKCkge1xuICAgIGxvZy5kZWJ1ZygnU3RvcHBpbmcgdG8gbGlzdGVuIGZvciBKYXZhU2NyaXB0IGNvbnNvbGUnKTtcbiAgICBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZW5kKCdzdG9wQ29uc29sZScsIHtcbiAgICAgIGFwcElkS2V5OiB0aGlzLmFwcElkS2V5LFxuICAgICAgcGFnZUlkS2V5OiB0aGlzLnBhZ2VJZEtleSxcbiAgICAgIGRlYnVnZ2VyVHlwZTogdGhpcy5kZWJ1Z2dlclR5cGVcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0TmV0d29yayAoZm4pIHtcbiAgICBsb2cuZGVidWcoJ1N0YXJ0aW5nIHRvIGxpc3RlbiBmb3IgbmV0d29yayBldmVudHMnKTtcbiAgICB0aGlzLnJwY0NsaWVudC5zZXROZXR3b3JrTG9nRXZlbnRIYW5kbGVyKGZuKTtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5ycGNDbGllbnQuc2VuZCgnc3RhcnROZXR3b3JrJywge1xuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgICAgZGVidWdnZXJUeXBlOiB0aGlzLmRlYnVnZ2VyVHlwZVxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgc3RvcE5ldHdvcmsgKCkge1xuICAgIGxvZy5kZWJ1ZygnU3RvcHBpbmcgdG8gbGlzdGVuIGZvciBuZXR3b3JrIGV2ZW50cycpO1xuICAgIGF3YWl0IHRoaXMucnBjQ2xpZW50LnNlbmQoJ3N0b3BOZXR3b3JrJywge1xuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgICAgZGVidWdnZXJUeXBlOiB0aGlzLmRlYnVnZ2VyVHlwZVxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgZXhlY3V0ZSAoY29tbWFuZCwgb3ZlcnJpZGUpIHtcbiAgICAvLyBpZiB0aGUgcGFnZSBpcyBub3QgbG9hZGVkIHlldCwgd2FpdCBmb3IgaXRcbiAgICBpZiAodGhpcy5wYWdlTG9hZGluZyAmJiAhb3ZlcnJpZGUpIHtcbiAgICAgIGxvZy5kZWJ1ZygnVHJ5aW5nIHRvIGV4ZWN1dGUgYnV0IHBhZ2UgaXMgbm90IGxvYWRlZC4nKTtcbiAgICAgIGF3YWl0IHRoaXMud2FpdEZvckRvbSgpO1xuICAgIH1cblxuICAgIC8vIG5vIG5lZWQgdG8gY2hlY2sgZXJyb3JzIGlmIGl0IGlzIHdlYmtpdFxuICAgIGlmICh0aGlzLmRlYnVnZ2VyVHlwZSA9PT0gREVCVUdHRVJfVFlQRVMud2ViaW5zcGVjdG9yKSB7XG4gICAgICBsZXQgZXJyb3JzID0gY2hlY2tQYXJhbXMoe2FwcElkS2V5OiB0aGlzLmFwcElkS2V5LCBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5fSk7XG4gICAgICBpZiAoZXJyb3JzKSB0aHJvdyBuZXcgRXJyb3IoZXJyb3JzKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuICAgIH1cblxuICAgIGlmICh0aGlzLmdhcmJhZ2VDb2xsZWN0T25FeGVjdXRlKSB7XG4gICAgICBhd2FpdCB0aGlzLmdhcmJhZ2VDb2xsZWN0KCk7XG4gICAgfVxuXG4gICAgbG9nLmRlYnVnKGBTZW5kaW5nIGphdmFzY3JpcHQgY29tbWFuZCAke18udHJ1bmNhdGUoY29tbWFuZCwge2xlbmd0aDogNTB9KX1gKTtcbiAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy5ycGNDbGllbnQuc2VuZCgnc2VuZEpTQ29tbWFuZCcsIHtcbiAgICAgIGNvbW1hbmQsXG4gICAgICBhcHBJZEtleTogdGhpcy5hcHBJZEtleSxcbiAgICAgIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXksXG4gICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXMuY29udmVydFJlc3VsdChyZXMpO1xuICB9XG5cbiAgYXN5bmMgY2FsbEZ1bmN0aW9uIChvYmpJZCwgZm4sIGFyZ3MpIHtcbiAgICBsZXQgZXJyb3JzID0gY2hlY2tQYXJhbXMoe2FwcElkS2V5OiB0aGlzLmFwcElkS2V5LCBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5fSk7XG4gICAgaWYgKGVycm9ycykgdGhyb3cgbmV3IEVycm9yKGVycm9ycyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgY3VybHlcblxuICAgIGlmICh0aGlzLmdhcmJhZ2VDb2xsZWN0T25FeGVjdXRlKSB7XG4gICAgICBhd2FpdCB0aGlzLmdhcmJhZ2VDb2xsZWN0KCk7XG4gICAgfVxuXG4gICAgbG9nLmRlYnVnKCdDYWxsaW5nIGphdmFzY3JpcHQgZnVuY3Rpb24nKTtcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZW5kKCdjYWxsSlNGdW5jdGlvbicsIHtcbiAgICAgIG9iaklkLFxuICAgICAgZm4sXG4gICAgICBhcmdzLFxuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgICAgZGVidWdnZXJUeXBlOiB0aGlzLmRlYnVnZ2VyVHlwZVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXMuY29udmVydFJlc3VsdChyZXMpO1xuICB9XG5cbiAgY29udmVydFJlc3VsdCAocmVzKSB7XG4gICAgaWYgKF8uaXNVbmRlZmluZWQocmVzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBEaWQgbm90IGdldCBPSyByZXN1bHQgZnJvbSByZW1vdGUgZGVidWdnZXIuIFJlc3VsdCB3YXM6ICR7Xy50cnVuY2F0ZShzaW1wbGVTdHJpbmdpZnkocmVzKSwge2xlbmd0aDogUkVTUE9OU0VfTE9HX0xFTkdUSH0pfWApO1xuICAgIH0gZWxzZSBpZiAoXy5pc1N0cmluZyhyZXMpKSB7XG4gICAgICB0cnkge1xuICAgICAgICByZXMgPSBKU09OLnBhcnNlKHJlcyk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gd2UgbWlnaHQgZ2V0IGEgc2VyaWFsaXplZCBvYmplY3QsIGJ1dCB3ZSBtaWdodCBub3RcbiAgICAgICAgLy8gaWYgd2UgZ2V0IGhlcmUsIGl0IGlzIGp1c3QgYSB2YWx1ZVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoIV8uaXNPYmplY3QocmVzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBSZXN1bHQgaGFzIHVuZXhwZWN0ZWQgdHlwZTogKCR7dHlwZW9mIHJlc30pLmApO1xuICAgIH1cblxuICAgIGlmIChyZXMuc3RhdHVzICYmIHJlcy5zdGF0dXMgIT09IDApIHtcbiAgICAgIC8vIHdlIGdvdCBzb21lIGZvcm0gb2YgZXJyb3IuXG4gICAgICB0aHJvdyBlcnJvckZyb21Db2RlKHJlcy5zdGF0dXMsIHJlcy52YWx1ZS5tZXNzYWdlIHx8IHJlcy52YWx1ZSk7XG4gICAgfVxuXG4gICAgLy8gd2l0aCBlaXRoZXIgaGF2ZSBhbiBvYmplY3Qgd2l0aCBhIGB2YWx1ZWAgcHJvcGVydHkgKGV2ZW4gaWYgYG51bGxgKSxcbiAgICAvLyBvciBhIHBsYWluIG9iamVjdFxuICAgIHJldHVybiByZXMuaGFzT3duUHJvcGVydHkoJ3ZhbHVlJykgPyByZXMudmFsdWUgOiByZXM7XG4gIH1cblxuICBhbGxvd05hdmlnYXRpb25XaXRob3V0UmVsb2FkIChhbGxvdyA9IHRydWUpIHtcbiAgICBpZiAoXy5pc0Z1bmN0aW9uKHRoaXMucnBjQ2xpZW50LmFsbG93TmF2aWdhdGlvbldpdGhvdXRSZWxvYWQpKSB7XG4gICAgICB0aGlzLnJwY0NsaWVudC5hbGxvd05hdmlnYXRpb25XaXRob3V0UmVsb2FkKGFsbG93KTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRDb29raWVzICh1cmxzKSB7XG4gICAgbG9nLmRlYnVnKCdHZXR0aW5nIG5ldHdvcmsgY29va2llcycpO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZW5kKCdnZXRDb29raWVzJywge1xuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgICAgZGVidWdnZXJUeXBlOiB0aGlzLmRlYnVnZ2VyVHlwZSxcbiAgICAgIHVybHMsXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBkZWxldGVDb29raWUgKGNvb2tpZU5hbWUsIHVybCkge1xuICAgIGxvZy5kZWJ1ZyhgRGVsZXRpbmcgY29va2llICcke2Nvb2tpZU5hbWV9JyBvbiAnJHt1cmx9J2ApO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZW5kKCdkZWxldGVDb29raWUnLCB7XG4gICAgICBhcHBJZEtleTogdGhpcy5hcHBJZEtleSxcbiAgICAgIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXksXG4gICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlLFxuICAgICAgY29va2llTmFtZSxcbiAgICAgIHVybCxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGdhcmJhZ2VDb2xsZWN0ICh0aW1lb3V0TXMgPSBHQVJCQUdFX0NPTExFQ1RfVElNRU9VVCkge1xuICAgIGxvZy5kZWJ1ZyhgR2FyYmFnZSBjb2xsZWN0aW5nIHdpdGggJHt0aW1lb3V0TXN9bXMgdGltZW91dGApO1xuICAgIGNvbnN0IGVycm9ycyA9IGNoZWNrUGFyYW1zKHtcbiAgICAgIGFwcElkS2V5OiB0aGlzLmFwcElkS2V5LFxuICAgICAgcGFnZUlkS2V5OiB0aGlzLnBhZ2VJZEtleSxcbiAgICB9KTtcbiAgICBpZiAoZXJyb3JzKSB7XG4gICAgICBsb2cuZGVidWcoYFVuYWJsZSB0byBjb2xsZWN0IGdhcmJhZ2UgYXQgdGhpcyB0aW1lYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgYXdhaXQgQi5yZXNvbHZlKHRoaXMucnBjQ2xpZW50LnNlbmQoJ2dhcmJhZ2VDb2xsZWN0Jywge1xuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgICAgZGVidWdnZXJUeXBlOiB0aGlzLmRlYnVnZ2VyVHlwZVxuICAgIH0pKS50aW1lb3V0KHRpbWVvdXRNcylcbiAgICAudGhlbihmdW5jdGlvbiAoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcHJvbWlzZS9wcmVmZXItYXdhaXQtdG8tdGhlblxuICAgICAgbG9nLmRlYnVnKGBHYXJiYWdlIGNvbGxlY3Rpb24gc3VjY2Vzc2Z1bGApO1xuICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBwcm9taXNlL3ByZWZlci1hd2FpdC10by1jYWxsYmFja3NcbiAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBCLlRpbWVvdXRFcnJvcikge1xuICAgICAgICBsb2cuZGVidWcoYEdhcmJhZ2UgY29sbGVjdGlvbiB0aW1lZCBvdXQgYWZ0ZXIgJHt0aW1lb3V0TXN9bXNgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhgVW5hYmxlIHRvIGNvbGxlY3QgZ2FyYmFnZTogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG4vLyBldmVudCBlbWl0dGVkIHB1YmxpY2FsbHlcblJlbW90ZURlYnVnZ2VyLkVWRU5UX1BBR0VfQ0hBTkdFID0gJ3JlbW90ZV9kZWJ1Z2dlcl9wYWdlX2NoYW5nZSc7XG5SZW1vdGVEZWJ1Z2dlci5FVkVOVF9GUkFNRVNfREVUQUNIRUQgPSAncmVtb3RlX2RlYnVnZ2VyX2ZyYW1lc19kZXRhY2hlZCc7XG5SZW1vdGVEZWJ1Z2dlci5FVkVOVF9ESVNDT05ORUNUID0gJ3JlbW90ZV9kZWJ1Z2dlcl9kaXNjb25uZWN0JztcblxuLy8gYWRkIGdlbmVyaWMgY2FsbGJhY2tzXG5mb3IgKGNvbnN0IFtuYW1lLCBoYW5kbGVyXSBvZiBfLnRvUGFpcnMobWVzc2FnZUhhbmRsZXJzKSkge1xuICBSZW1vdGVEZWJ1Z2dlci5wcm90b3R5cGVbbmFtZV0gPSBoYW5kbGVyO1xufVxuXG5leHBvcnQge1xuICBSZW1vdGVEZWJ1Z2dlciwgREVCVUdHRVJfVFlQRVMsIFJFTU9URV9ERUJVR0dFUl9QT1JULCBSUENfUkVTUE9OU0VfVElNRU9VVF9NUyxcbn07XG4iXSwiZmlsZSI6ImxpYi9yZW1vdGUtZGVidWdnZXIuanMiLCJzb3VyY2VSb290IjoiLi4vLi4ifQ==
